/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   main.c                                             :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: mtellal <marvin@42.fr>                     +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/09/17 16:31:58 by mtellal           #+#    #+#             */
/*   Updated: 2022/09/17 22:18:47 by mtellal          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "cub3d.h"

static char	map[14][35] = 
{
{'0','0','0','0','0','0','0','0','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1','1'},
{'0','0','0','0','0','0','0','0','1','0','0','0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','0','0','0','0','0','0','1'},
{'0','0','0','0','0','0','0','0','1','0','1','1','0','0','0','0','0','1','1','1','0','0','0','0','0','0','0','0','0','0','0','0','1'},
{'0','0','0','0','0','0','0','0','1','0','0','1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','1'},
{'1','1','1','1','1','1','1','1','1','0','1','1','0','0','0','0','0','1','1','1','0','0','0','0','0','0','0','0','0','0','0','0','1'},
{'1','0','0','0','0','0','0','0','0','0','1','1','0','0','0','0','0','1','1','1','0','1','1','1','1','1','1','1','1','1','1','1','1'},
{'1','1','1','1','0','1','1','1','1','1','1','1','1','1','0','1','1','1','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0'},
{'1','1','1','1','0','1','1','1','1','1','1','1','1','1','0','1','1','1','0','1','0','1','0','0','1','0','0','0','1','0','0','0','0'},
{'1','1','0','0','0','0','0','0','1','1','0','1','0','1','0','1','1','1','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0'},
{'1','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','1','1','0','0','0','0','0','0','1','0','0','0','1','0','0','0','0'},
{'1','0','0','0','0','0','0','N','0','0','0','0','0','0','0','0','1','1','0','1','0','1','0','0','1','0','0','0','1','0','0','0','0'},
{'1','1','0','0','0','0','0','1','1','1','0','1','0','1','0','1','1','1','1','1','0','1','1','1','1','0','0','0','1','1','1','0','0'},
{'1','1','1','1','0','1','1','1','0','1','1','1','0','1','0','1','0','1','0','1','1','1','1','0','1','0','0','0','1','0','0','0','0'},
{'1','1','1','1','1','1','1','1','0','1','1','1','1','1','1','1','0','1','1','1','1','1','1','1','1','1','1','1','1','0','0','0','0'}
};

// ligne 9
// lligne 33

void	fillWalls(t_frame *img, char map[14][35])
{
	int i = 0;
	int j = 0;
	t_wall	w;
/* 	t_wall	perso; */

	w.size = 20;
	w.color = 0x00B0FF00;
/* 	perso.size = 20;
	perso.color = 0x00250060; */

	while (i < 14)
	{
		j = 0;
		while (j < 35)
		{
			if (map[i][j] == '1')
				draw_wall(img, w, i * w.size, j * w.size);
			else if (map[i][j] == 'N')
			{
				img->triangle.ipos.x = i * w.size;
				img->triangle.ipos.y = j * w.size;

				img->triangle.a.x = j * 20 + 10;
				img->triangle.a.y = i * 20 + 5;

				img->triangle.b.x = j * 20 + 5;
				img->triangle.b.y = i * 20 + 15;

				img->triangle.c.x = j * 20 + 15;
				img->triangle.c.y = i * 20 + 15;

				img->triangle.milieu.x = j * 20 + 10;
				img->triangle.milieu.y = i * 20 + 10;

				img->triangle.color = 0x00F50600;

				put_pixel(img, img->triangle.milieu.y, img->triangle.milieu.x, 0x00FFFFFF);
				//draw_wall(img, w, i * w.size, j * w.size);

				draw_triangle(img, img->triangle);
 			}
			j++;
		}
		i++;
	}
}

int main()
{
	t_frame	img;

	img.mlx = mlx_init();
	img.window = mlx_new_window(img.mlx, LENGTH * 20, HEIGHT * 20, "cub3d");
	
	img.img = mlx_new_image(img.mlx, LENGTH * 20, HEIGHT * 20);
	
	img.addr = mlx_get_data_addr(img.img, &img.bpp, &img.length, &img.endian);

	fillWalls(&img, map);
	
	mlx_hook(img.window, 2, 1L<<0,  moove, &img);
	
	
	push_frame(&img);
	
	mlx_loop(img.mlx);
	
}
